# 修改 llava-med-v1.5-mistral-7b.yaml
alg_name: "WISE"
model_name: "./hugging_cache/llava-med-v1.5-mistral-7b"

device: 1

mask_ratio: 1.0
edit_lr: 0.2
n_iter: 10
norm_constraint: 1.0
act_margin: [5.0, 20.0, 10.0]
act_ratio: 0.4
save_freq: 500
merge_freq: 1000
merge_alg: 'ties'
objective_optimization: 'only_label'

# 修正 inner_params - 对应 Mistral 7B 的结构
inner_params:
  # Mistral 7B 有 32 层，取倒数第二层
  - language_model.model.layers.31.mlp.down_proj.weight
  # 或者可以尝试以下路径之一：
  # - language_model.model.layers.30.mlp.down_proj.weight
  # - text_model.model.layers.31.mlp.down_proj.weight

# for merge (if merge)
densities: 0.53
weights: 1.0

# for retrieve (if retrieve)
retrieve: True
replay: False

model_parallel: True
use_chat_template: True

# Multimodal
exact_match: True
hidden_act: silu
qformer_checkpoint: .
qformer_name_or_path: .
state_dict_file: .

# 修正图像文件类型
file_type: image  # 从 video 改为 image
coco_image: ../
rephrase_image: ../